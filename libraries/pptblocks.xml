<blocks app="Snap! 4.2, http://snap.berkeley.edu" version="1"><block-definition s="线段长度 %&apos;line&apos;" type="reporter" category="sensing"><header></header><code></code><translations>en:length of line _&#xD;</translations><inputs><input type="%l"></input></inputs><script><block s="doIfElse"><block s="reportLessThan"><block s="reportListLength"><block var="line"/></block><l>2</l></block><script><block s="doReport"><l>-1</l></block></script><script><block s="doIfElse"><block s="reportIsA"><block s="reportListItem"><l>1</l><block var="line"/></block><l><option>number</option></l></block><script><block s="doReport"><block s="reportMonadic"><l><option>sqrt</option></l><block s="reportSum"><block s="reportProduct"><block s="reportDifference"><block s="xPosition"></block><block s="reportListItem"><l>1</l><block var="line"/></block></block><block s="reportDifference"><block s="xPosition"></block><block s="reportListItem"><l>1</l><block var="line"/></block></block></block><block s="reportProduct"><block s="reportDifference"><block s="yPosition"></block><block s="reportListItem"><l>2</l><block var="line"/></block></block><block s="reportDifference"><block s="yPosition"></block><block s="reportListItem"><l>2</l><block var="line"/></block></block></block></block></block></block></script><script><block s="doReport"><block s="reportMonadic"><l><option>sqrt</option></l><block s="reportSum"><block s="reportProduct"><block s="reportDifference"><block s="reportListItem"><l>1</l><block s="reportListItem"><l>1</l><block var="line"/></block></block><block s="reportListItem"><l>1</l><block s="reportListItem"><l>2</l><block var="line"/></block></block></block><block s="reportDifference"><block s="reportListItem"><l>1</l><block s="reportListItem"><l>1</l><block var="line"/></block></block><block s="reportListItem"><l>1</l><block s="reportListItem"><l>2</l><block var="line"/></block></block></block></block><block s="reportProduct"><block s="reportDifference"><block s="reportListItem"><l>2</l><block s="reportListItem"><l>1</l><block var="line"/></block></block><block s="reportListItem"><l>2</l><block s="reportListItem"><l>2</l><block var="line"/></block></block></block><block s="reportDifference"><block s="reportListItem"><l>2</l><block s="reportListItem"><l>1</l><block var="line"/></block></block><block s="reportListItem"><l>2</l><block s="reportListItem"><l>2</l><block var="line"/></block></block></block></block></block></block></block></script></block></script></block></script></block-definition><block-definition s="all but first letter of %&apos;string&apos;" type="reporter" category="operators"><comment x="0" y="0" w="199" collapsed="false">Takes a text string as input, and reports a new text string containing all but the first character of the input.</comment><header></header><code></code><translations></translations><inputs><input type="%txt"></input></inputs><script><block s="doDeclareVariables"><list><l>result</l><l>i</l></list></block><block s="doWarp"><script><block s="doIf"><block s="reportEquals"><block s="reportStringSize"><block var="string"/></block><l>0</l></block><script><block s="doReport"><block s="reportListItem"><l>1</l><block s="reportSum"><l>0</l><l>0</l></block></block></block></script></block><block s="doSetVar"><l>result</l><l></l></block><block s="doSetVar"><l>i</l><l>2</l></block><block s="doUntil"><block s="reportGreaterThan"><block var="i"/><block s="reportStringSize"><block var="string"/></block></block><script><block s="doSetVar"><l>result</l><block s="reportJoinWords"><list><block var="result"/><block s="reportLetter"><block var="i"/><block var="string"/></block></list></block></block><block s="doChangeVar"><l>i</l><l>1</l></block></script></block><block s="doReport"><block var="result"/></block></script></block></script></block-definition><block-definition s="文字边框 左上角 %&apos;leftTop&apos; 宽度 %&apos;width&apos; 高度 %&apos;height&apos; 有边框 %&apos;hasBorder&apos; 边框颜色 %&apos;borderColor&apos; 有背景 %&apos;hasBackground&apos; 背景颜色 %&apos;backgroundColor&apos;" type="command" category="pen"><header></header><code></code><translations>en:frame leftop _ width _ height _ hasFrame _ frameColor _ hasBackground _ backgroundColor _&#xD;</translations><inputs><input type="%l"></input><input type="%n">300</input><input type="%n">200</input><input type="%b">true</input><input type="%l"></input><input type="%b">false</input><input type="%l"></input></inputs><script><block s="doDeclareVariables"><list><l>x</l><l>y</l><l>dir</l><l>penColor</l></list></block><block s="doSetVar"><l>penColor</l><custom-block s="RGB color"></custom-block></block><block s="up"></block><block s="doSetVar"><l>x</l><block s="xPosition"></block></block><block s="doSetVar"><l>y</l><block s="yPosition"></block></block><block s="doSetVar"><l>dir</l><block s="direction"></block></block><block s="doGotoObject"><block var="leftTop"/></block><block s="setHeading"><l>90</l></block><block s="doIf"><block s="reportOr"><block var="hasBorder"/><block var="hasBackground"/></block><script><block s="doIfElse"><block var="hasBorder"/><script><custom-block s="设置画笔颜色为 红: %n 绿: %n 蓝: %n"><block s="reportListItem"><l>1</l><block var="borderColor"/></block><block s="reportListItem"><l>2</l><block var="borderColor"/></block><block s="reportListItem"><l>3</l><block var="borderColor"/></block></custom-block></script><script><custom-block s="设置画笔颜色为 红: %n 绿: %n 蓝: %n"><block s="reportListItem"><l>1</l><block var="backgroundColor"/></block><block s="reportListItem"><l>2</l><block var="backgroundColor"/></block><block s="reportListItem"><l>3</l><block var="backgroundColor"/></block></custom-block></script></block><block s="down"></block><block s="doRepeat"><l>2</l><script><block s="forward"><block var="width"/></block><block s="turn"><l>90</l></block><block s="forward"><block var="height"/></block><block s="turn"><l>90</l></block></script></block><block s="up"></block><block s="turn"><l>45</l></block><block s="forward"><block s="reportQuotient"><block var="height"/><l>2</l></block></block><block s="doIf"><block var="hasBackground"/><script><custom-block s="设置画笔颜色为 红: %n 绿: %n 蓝: %n"><block s="reportListItem"><l>1</l><block var="backgroundColor"/></block><block s="reportListItem"><l>2</l><block var="backgroundColor"/></block><block s="reportListItem"><l>3</l><block var="backgroundColor"/></block></custom-block><block s="floodFill"></block></script></block><block s="gotoXY"><block var="x"/><block var="y"/></block><block s="setHeading"><block var="dir"/></block><custom-block s="设置画笔颜色为 红: %n 绿: %n 蓝: %n"><block s="reportListItem"><l>1</l><block var="penColor"/></block><block s="reportListItem"><l>2</l><block var="penColor"/></block><block s="reportListItem"><l>3</l><block var="penColor"/></block></custom-block></script></block></script></block-definition><block-definition s="多行文本 %&apos;text&apos; 大小 %&apos;size&apos; 左上角 %&apos;topLeft&apos; 宽度 %&apos;width&apos; 字体 %&apos;font&apos; 行间距 %&apos;lineGap&apos; 继续下行 %&apos;continue&apos;" type="command" category="pen"><header></header><code></code><translations>en:multiline text _ size _ lefttop _ width _ font _ gap _ continue _&#xD;</translations><inputs><input type="%txt">How are you!</input><input type="%n">12</input><input type="%l"></input><input type="%n">300</input><input type="%txt">SimSong</input><input type="%n">0.5</input><input type="%b">true</input></inputs><script><block s="doDeclareVariables"><list><l>distance</l><l>myText</l><l>x</l><l>y</l><l>dir</l><l>tl</l></list></block><block s="doIf"><block s="reportGreaterThan"><block s="reportStringSize"><block var="text"/></block><l>0</l></block><script><block s="doSetVar"><l>myText</l><block var="text"/></block><block s="doSetVar"><l>distance</l><l>0</l></block><block s="doSetVar"><l>x</l><block s="xPosition"></block></block><block s="doSetVar"><l>y</l><block s="yPosition"></block></block><block s="doSetVar"><l>dir</l><block s="direction"></block></block><block s="up"></block><block s="doIfElse"><block s="reportAnd"><block s="reportIsA"><block var="topLeft"/><l><option>list</option></l></block><block s="reportEquals"><block s="reportListLength"><block var="topLeft"/></block><l>2</l></block></block><script><block s="doGotoObject"><block var="topLeft"/></block><block s="doSetVar"><l>tl</l><block var="topLeft"/></block></script><script><block s="doSetVar"><l>tl</l><block s="reportNewList"><list><block s="xPosition"></block><block s="yPosition"></block></list></block></block></script></block><block s="doWarp"><script><block s="doUntil"><block s="reportEquals"><block s="reportStringSize"><block var="myText"/></block><l>0</l></block><script><block s="doUntil"><block s="reportOr"><block s="reportLessThan"><block s="reportDifference"><block var="width"/><block var="distance"/></block><block var="size"/></block><block s="reportEquals"><block s="reportStringSize"><block var="myText"/></block><l>0</l></block></block><script><custom-block s="文本 %txt 大小 %n 字体 %txt"><block s="reportLetter"><l>1</l><block var="myText"/></block><block var="size"/><block var="font"/></custom-block><block s="doSetVar"><l>myText</l><custom-block s="all but first letter of %txt"><block var="myText"/></custom-block></block><block s="doSetVar"><l>distance</l><custom-block s="线段长度 %l"><block s="reportNewList"><list><block var="tl"/><block s="reportNewList"><list><block s="xPosition"></block><block s="yPosition"></block></list></block></list></block></custom-block></block></script></block><block s="doSetVar"><l>tl</l><block s="reportNewList"><list><block s="reportListItem"><l>1</l><block var="tl"/></block><block s="reportDifference"><block s="reportListItem"><l>2</l><block var="tl"/></block><block s="reportProduct"><block var="size"/><block s="reportSum"><l>1</l><block var="lineGap"/></block></block></block></list></block></block><block s="doSetVar"><l>distance</l><l>0</l></block><block s="doGotoObject"><block var="tl"/></block></script></block><block s="doIf"><block s="reportNot"><block var="continue"/></block><script><block s="gotoXY"><block var="x"/><block var="y"/></block><block s="setHeading"><block var="dir"/></block></script></block></script></block></script></block></script></block-definition><block-definition s="设置画笔颜色为 红: %&apos;r&apos; 绿: %&apos;g&apos; 蓝: %&apos;b&apos;" type="command" category="pen"><header></header><code></code><translations>en:set pen color to R _ G _ B _&#xD;</translations><inputs><input type="%n">255</input><input type="%n">0</input><input type="%n">0</input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>r</l><l>g</l><l>b</l></list><l>this.setColor(new Color(r, g, b));</l></block><list><block var="r"/><block var="g"/><block var="b"/></list></block></script></block-definition><block-definition s="图章 左上角 %&apos;leftTop&apos; 宽度 %&apos;width&apos;" type="command" category="pen"><header></header><code></code><translations>en:stamp lefttop _ width _&#xD;</translations><inputs><input type="%l"></input><input type="%n">100</input></inputs><script><block s="doDeclareVariables"><list><l>x</l><l>y</l><l>dir</l><l>size</l></list></block><block s="doSetVar"><l>x</l><block s="xPosition"></block></block><block s="doSetVar"><l>y</l><block s="yPosition"></block></block><block s="doSetVar"><l>dir</l><block s="direction"></block></block><block s="up"></block><block s="doSetVar"><l>size</l><block s="getScale"></block></block><block s="setScale"><block s="reportProduct"><block s="reportQuotient"><block var="width"/><custom-block s="%txt of %txt"><l>width</l><block s="reportGet"><l><option>name</option></l></block></custom-block></block><l>100</l></block></block><block s="doGotoObject"><block s="reportNewList"><list><block s="reportSum"><block s="reportListItem"><l>1</l><block var="leftTop"/></block><block s="reportQuotient"><block var="width"/><l>2</l></block></block><block s="reportDifference"><block s="reportListItem"><l>2</l><block var="leftTop"/></block><block s="reportQuotient"><block s="reportProduct"><block s="reportQuotient"><block var="width"/><custom-block s="%txt of %txt"><l>width</l><block s="reportGet"><l><option>name</option></l></block></custom-block></block><custom-block s="%txt of %txt"><l>height</l><block s="reportGet"><l><option>name</option></l></block></custom-block></block><l>2</l></block></block></list></block></block><block s="doStamp"></block><block s="gotoXY"><block var="x"/><block var="y"/></block><block s="setHeading"><block var="dir"/></block><block s="setScale"><block var="size"/></block></script></block-definition><block-definition s="当前画布像素" type="reporter" category="pen"><header></header><code></code><translations>en:color of current pixel&#xD;</translations><inputs></inputs><script><block s="doDeclareVariables"><list><l>r</l></list></block><block s="doSetVar"><l>r</l><block s="evaluate"><block s="reportJSFunction"><list></list><l>var layer = normalizeCanvas(this.parent.penTrails()),&#xD;    width = layer.width,&#xD;    height = layer.height,&#xD;    ctx = layer.getContext(&apos;2d&apos;),&#xD;    img = ctx.getImageData(0, 0, width, height),&#xD;    dta = img.data,&#xD;    p = (Math.round((height / 2)) - Math.round(this.yPosition())) * width +&#xD;            Math.round(this.xPosition() + (width / 2)),&#xD;    d = p*4;&#xD;return new List([dta[d], dta[d + 1], dta[d + 2], dta[d+3]]);&#xD;</l></block><list></list></block></block><block s="doReport"><block var="r"/></block></script></block-definition><block-definition s="CMYK %&apos;cmyk&apos; to RGB" type="reporter" category="pen"><header></header><code></code><translations></translations><inputs><input type="%l"></input></inputs><script><block s="doReport"><block s="reportNewList"><list><block s="reportQuotient"><block s="reportProduct"><block s="reportProduct"><l>255</l><block s="reportDifference"><l>100</l><block s="reportListItem"><l>1</l><block var="cmyk"/></block></block></block><block s="reportDifference"><l>100</l><block s="reportListItem"><l>4</l><block var="cmyk"/></block></block></block><l>10000</l></block><block s="reportQuotient"><block s="reportProduct"><block s="reportProduct"><l>255</l><block s="reportDifference"><l>100</l><block s="reportListItem"><l>2</l><block var="cmyk"/></block></block></block><block s="reportDifference"><l>100</l><block s="reportListItem"><l>4</l><block var="cmyk"/></block></block></block><l>10000</l></block><block s="reportQuotient"><block s="reportProduct"><block s="reportProduct"><l>255</l><block s="reportDifference"><l>100</l><block s="reportListItem"><l>3</l><block var="cmyk"/></block></block></block><block s="reportDifference"><l>100</l><block s="reportListItem"><l>4</l><block var="cmyk"/></block></block></block><l>10000</l></block></list></block></block></script></block-definition><block-definition s="%&apos;para&apos; of %&apos;sprite&apos;" type="reporter" category="sensing"><header></header><code></code><translations></translations><inputs><input type="%txt">width<options>width&#xD;height</options></input><input type="%txt"></input></inputs><script><block s="doIf"><block s="reportEquals"><block var="para"/><l>width</l></block><script><block s="doReport"><block s="reportAskFor"><block var="sprite"/><block s="reifyReporter"><autolambda><block s="evaluate"><block s="reportJSFunction"><list></list><l>var stage = this.parentThatIsA(StageMorph);&#xD;return this.extent().x/stage.scale;</l></block><list></list></block></autolambda><list></list></block><list></list></block></block></script></block><block s="doIf"><block s="reportEquals"><block var="para"/><l>height</l></block><script><block s="doReport"><block s="reportAskFor"><block var="sprite"/><block s="reifyReporter"><autolambda><block s="evaluate"><block s="reportJSFunction"><list></list><l>var stage = this.parentThatIsA(StageMorph);&#xD;return this.extent().y/stage.scale;</l></block><list></list></block></autolambda><list></list></block><list></list></block></block></script></block><block s="doReport"><l></l></block></script></block-definition><block-definition s="排列图片 %&apos;image&apos; 属于 %&apos;sprite&apos; 左上角 %&apos;lefttop&apos; 宽度 %&apos;width&apos;" type="command" category="pen"><header></header><code></code><translations>en:put image _ of _ lefttop _ width _&#xD;</translations><inputs><input type="%txt"></input><input type="%txt"></input><input type="%l"></input><input type="%n">100</input></inputs><script><custom-block s="命令 %s 运行 %cs"><block var="sprite"/><script><block s="doSwitchToCostume"><block var="image"/></block><custom-block s="图章 左上角 %l 宽度 %n"><block var="lefttop"/><block var="width"/></custom-block></script></custom-block></script></block-definition><block-definition s="文本 %&apos;text&apos; 大小 %&apos;size&apos; 字体 %&apos;font&apos;" type="command" category="pen"><comment x="0" y="0" w="90" collapsed="false">LABEL will stamp text on the stage at the given font size. The direction of the text is the direction the sprite is facing, and color will match the pen color.</comment><header></header><code></code><translations>en:text _ size _ font _&#xD;</translations><inputs><input type="%txt">Hello!</input><input type="%n">12</input><input type="%txt">monospace<options>monospace&#xD;Arial&#xD;SimSong&#xD;SimHei&#xD;Microsoft YaHei&#xD;FangSong&#xD;KaiTi</options></input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>text</l><l>size</l><l>font</l></list><l>var stage = this.parentThatIsA(StageMorph),&#xD;    trailsOffset = new Point(Math.floor((stage.penTrails().width-stage.bounds.width()/stage.scale)/2),Math.floor((stage.penTrails().height-stage.bounds.height()/stage.scale)/2)),    &#xD;    context = stage.penTrails().getContext(&apos;2d&apos;),&#xD;    rotation = radians(this.direction() - 90),&#xD;    trans = new Point(&#xD;      this.center().x - stage.left() + trailsOffset.x * stage.scale,&#xD;      this.center().y - stage.top() + trailsOffset.y * stage.scale&#xD;    ),&#xD;    isWarped = this.Warped,&#xD;    len,&#xD;    pos;&#xD;&#xD;if (isWarped) {endWarp(); }&#xD;context.save();&#xD;context.font = size + &apos;px &apos; + font;&#xD;context.textAlign = &apos;left&apos;;&#xD;context.textBaseline = &apos;alphabetic&apos;;&#xD;context.fillStyle = this.color.toString();&#xD;len = context.measureText(text).width;&#xD;trans = trans.multiplyBy(1 / stage.scale);&#xD;context.translate(trans.x, trans.y);&#xD;context.rotate(rotation);&#xD;context.fillText(text, 0, 0);&#xD;context.translate(-trans.x, -trans.y);&#xD;context.restore();&#xD;pos = new Point(&#xD;  len * Math.sin(radians(this.direction())),&#xD;  len * Math.cos(radians(this.direction())));&#xD;pos = pos.add(new Point(this.xPosition(), this.yPosition()));&#xD;this.gotoXY(pos.x, pos.y, false);&#xD;this.changed();&#xD;if (isWarped) {this.startWarp(); }&#xD;stage.changed();</l></block><list><block var="text"/><block var="size"/><block var="font"/></list></block></script></block-definition><block-definition s="命令 %&apos;sprite&apos; 运行 %&apos;action&apos;" type="command" category="control"><header></header><code></code><translations></translations><inputs><input type="%s">Sprite</input><input type="%cs"></input></inputs><script><block s="doRun"><block s="reportAttributeOf"><block var="action"/><block var="sprite"/></block><list></list></block></script></block-definition><block-definition s="RGB color" type="reporter" category="pen"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return new List([this.color.r, this.color.g, this.color.b]);</l></block><list></list></block></block></script></block-definition><block-definition s="HSV color" type="reporter" category="pen"><header></header><code></code><translations></translations><inputs></inputs><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l></l></list><l>return new List(this.color.hsv());</l></block><list></list></block></block></script></block-definition></blocks>